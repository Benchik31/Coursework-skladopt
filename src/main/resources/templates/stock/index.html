<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/layout :: head(~{::title})}">
    <title>Остатки | Склад</title>
</head>
<body>
<div th:replace="~{fragments/layout :: layout(~{::title}, ~{::main})}">
    <main>
        <div th:replace="~{fragments/breadcrumbs :: breadcrumbs('Остатки')}"></div>
        <div class="d-flex align-items-center justify-content-between mb-3">
            <div>
                <h1 class="h4 mb-0">Остатки по складам</h1>
                <p class="text-muted mb-0">Фильтры и движения добавим позже. Ниже — текущие остатки и резервы.</p>
            </div>
            <div class="btn-group">
                <a class="btn btn-outline-primary" th:href="@{'/stock-movements/new?type=IN'}">Приход</a>
                <a class="btn btn-outline-primary" th:href="@{'/stock-movements/new?type=OUT'}">Расход</a>
                <a class="btn btn-outline-primary" th:href="@{'/stock-movements/new?type=TRANSFER'}">Перемещение</a>
            </div>
        </div>

        <div class="table-responsive">
            <table class="table table-hover align-middle">
                <thead class="table-light">
                <tr>
                    <th>Товар</th>
                    <th>Склад</th>
                    <th class="text-end">Доступно</th>
                    <th class="text-end">Резерв</th>
                    <th class="text-end">Мин. уровень</th>
                    <th>Статус</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="item : ${items}">
                    <td>
                        <div class="fw-semibold" th:text="${item.product.name}">Название</div>
                        <div class="text-muted small" th:text="${item.product.sku}">SKU</div>
                    </td>
                    <td th:text="${item.warehouse.name}">Склад</td>
                    <td class="text-end" th:text="${item.available}">0</td>
                    <td class="text-end" th:text="${item.reservedQty}">0</td>
                    <td class="text-end" th:text="${item.product.minStock != null ? item.product.minStock : '-'}">0</td>
                    <td>
                        <span th:if="${item.product.minStock != null and item.available.compareTo(item.product.minStock) < 0}"
                              class="badge text-bg-danger">Ниже минимума</span>
                        <span th:if="${item.product.minStock == null or item.available.compareTo(item.product.minStock) >= 0}"
                              class="badge text-bg-success">Ок</span>
                    </td>
                </tr>
                <tr th:if="${#lists.isEmpty(items)}">
                    <td colspan="6" class="text-center text-muted py-4">Данные по остаткам отсутствуют.</td>
                </tr>
                </tbody>
            </table>
        </div>
    </main>
</div>
</body>
</html>
